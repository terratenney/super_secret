<html>
<head>
  <meta charset=utf-8 />
  <title>Feature Collection Parsing</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src="//cdn.jsdelivr.net/leaflet/0.7.3/leaflet.js"></script>
<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="./js/esri-leaflet.js"></script>
<script src="./js/jquery-sidebar.js"></script>
<script src="./js/esri-leaflet-geocoder.js"></script>
<link rel="stylesheet" type="text/css" href="./css/esri-leaflet-geocoder.css">

<!-- Load Leaflet from CDN-->
<link rel="stylesheet" href="//cdn.jsdelivr.net/leaflet/0.7.3/leaflet.css" />
<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="./css/ol3-sidebar.css" />

  <style>
    body {margin:0;padding:0;overflow: hidden;}
    #map {position: absolute;top:0;bottom:0;right:0;left:0;}
	@page { margin: 0.79in }
		p { margin-bottom: 0.1in; line-height: 120% }
		td p { margin-bottom: 0in }
		a:link { so-language: zxx }

	.lorem {
		    font-style: bold;
		    color: #AAA;
		}
	.info {
	    padding: 6px 8px;
	    font: 14px/16px Arial, Helvetica, sans-serif;
	    background: white;
	    background: rgba(255,255,255,0.8);
	    box-shadow: 0 0 15px rgba(0,0,0,0.2);
	    border-radius: 5px;
	}

	.info h4 {
	    margin: 0 0 5px;
	    color: #777;}
	.legend {
	    line-height: 18px;
	    color: #555;
	}
	.legend i {
	    width: 18px;
	    height: 18px;
	    float: left;
	    margin-right: 8px;
	    opacity: 0.7;
	}

</style>
</head>
<body>
<div id="sidebar" class="sidebar collapsed">
        <!-- Nav tabs -->
        <ul class="sidebar-tabs" role="tablist">
            <li><a href="#home" role="tab"><i class="fa fa-bars"></i></a></li>
            <li><a href="#profile" role="tab"><i class="fa fa-user"></i></a></li>
            <li><a href="#messages" role="tab"><i class="fa fa-envelope"></i></a></li>
            <li><a href="#settings" role="tab"><i class="fa fa-gear"></i></a></li>
        </ul>

        <!-- Tab panes -->
        <div class="sidebar-content active">
            <div class="sidebar-pane" id="home">
                <h1>sidebar-v2</h1>

                <p>A responsive sidebar for mapping libraries like <a href="http://leafletjs.com/">Leaflet</a> or <a href="http://openlayers.org/">OpenLayers</a>.</p>

                <p class="lorem">Lorem ipsum .</p>

                <p class="lorem">Lorem.</p>

                <p class="lorem">Lorem ipsum dolor .</p>

                <p class="lorem">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. .</p>
            </div>
            <div class="sidebar-pane" id="profile"><h1>Meet the Neighbors</h1>
<p class="lorem">Lots of people are on social media these days and with CODE you can find people in your local area. Here we have a search around your area for people on Twitter. You can see how many followers they have and send them a message by clicking the link. Give it a try and meet someone!</p>
<table width="100%" cellpadding="4" cellspacing="0">
	<col width="85*">
	<col width="85*">
	<col width="85*">
	<tr>
		<td width="33%" style="border-top: 1px dotted #000000; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center"><font face="helvetica, sans-serif"><font size="4" style="font-size: 14pt"><b>Local
			User</b></font></font></p>
		</td>
		<td width="33%" style="border-top: 1px dotted #000000; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center"><font face="helvetica, sans-serif"><font size="4" style="font-size: 14pt"><b>Number of Followers
			</b></p>
		</td>
		<td width="33%" style="border: 1px dotted #000000; padding: 0.04in">
			<p align="center"><font face="helvetica, sans-serif"><font size="4" style="font-size: 14pt"><b>Send a Message
			</b></font></font>
			</p>
			
		</td>
	</tr>
	<tr>
		<td width="33%" height="53" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0.1in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center" style="margin-bottom: 0in"><img src="https://pbs.twimg.com/profile_images/537836138187071490/T8f_hu6s.jpeg" name="Image2" align="center" width="75" height="75" border="0"/>
<br/></p>
			<p align="center"><font face="helvetica, sans-serif"><font size="2" style="font-size: 11pt">Aman Dhanji</font></font></p>
		</td>

		<td width="33%" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center"><font face="helvetica, sans-serif"><font size="4" style="font-size: 14pt">43</font></font></p>
		</td>

		<td width="33%" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: 1px dotted #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
			<p align="center"><a href="https://twitter.com/amanmama" target="_blank"><img src="./img/envelope.png" name="Image1" align="center" width="55" height="32" border="0"/>
<br/>

			</p>
		</td>
	</tr>
	
	<tr>
		<td width="33%" height="53" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0.1in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center" style="margin-bottom: 0in"><img src="https://pbs.twimg.com/profile_images/1635845275/Friday_fishing.jpg" name="Image2" align="center" width="75" height="75" border="0"/>
<br/></p>
			<p align="center"><font face="helvetica, sans-serif"><font size="2" style="font-size: 11pt">Bill Cooper</font></font></p>
		</td>

		<td width="33%" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center"><font face="helvetica, sans-serif"><font size="4" style="font-size: 14pt">489</font></font></p>
		</td>

		<td width="33%" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: 1px dotted #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
			<p align="center"><a href="https://twitter.com/wjgcooper" target="_blank"><img src="./img/envelope.png" name="Image1" align="center" width="55" height="32" border="0"/>
<br/>

			</p>
		</td>
	</tr>
	
	
	<tr>
		<td width="33%" height="53" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0.1in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center" style="margin-bottom: 0in"><img src="https://pbs.twimg.com/profile_images/526526333287804928/lw0X-c-5.jpeg" name="Image2" align="center" width="75" height="75" border="0"/>
<br/></p>
			<p align="center"><font face="helvetica, sans-serif"><font size="2" style="font-size: 11pt">Jay Holtslander</font></font></p>
		</td>

		<td width="33%" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center"><font face="helvetica, sans-serif"><font size="4" style="font-size: 14pt">1310</font></font></p>
		</td>

		<td width="33%" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: 1px dotted #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
			<p align="center"><a href=https://twitter.com/j_holtslander" target="_blank"><img src="./img/envelope.png" name="Image1" align="center" width="55" height="32" border="0"/>
<br/>

			</p>
		</td>
	</tr>
	
<tr>
		<td width="33%" height="53" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0.1in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center" style="margin-bottom: 0in"><img src="https://pbs.twimg.com/profile_images/572251529944391680/ce6b61kE.jpeg" name="Image2" align="center" width="75" height="75" border="0"/>
<br/></p>
			<p align="center"><font face="helvetica, sans-serif"><font size="2" style="font-size: 11pt">Ginny Monaco</font></font></p>
		</td>

		<td width="33%" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: none; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="center"><font face="helvetica, sans-serif"><font size="4" style="font-size: 14pt">1106</font></font></p>
		</td>

		<td width="33%" style="border-top: none; border-bottom: 1px dotted #000000; border-left: 1px dotted #000000; border-right: 1px dotted #000000; padding-top: 0in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0.04in">
			<p align="center"><a href="https://twitter.com/ginnymonaco" target="_blank"><img src="./img/envelope.png" name="Image1" align="center" width="55" height="32" border="0"/>
<br/>

			</p>
		</td>
	</tr>
	
</table>

</div>
            <div class="sidebar-pane" id="messages"><h1>Messages</h1>




</div>
            <div class="sidebar-pane" id="settings"><h1>Settings</h1>
              
            
              
            
              
            </div>
        </div>
    </div>
<div id="map" class="sidebar-map"></div>



<script src="/js/edmon_data.js"></script>
<script src="/js/van_data.js"></script>

<script>

var map = L.map('map').setView([53.53, -113.50], 11);
var layer;
L.esri.basemapLayer("Topographic").addTo(map);





function getColor(d) {
        return d > 45000 ? '#800026' :
            d > 35000 ? '#BD0026' :
            d > 25000 ? '#E31A1C' :
            d > 20000 ? '#FC4E2A' :
            d > 15000 ? '#FD8D3C' :
            d > 10000 ? '#FEB24C' :
            d >  0 ? '#FED976' : '#FFEDA0';
    }

function style(feature) {
	
        return {
            fillColor: getColor(feature.properties.Med_Inc_F),
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '3',
            fillOpacity: 0.7
        };

    }

function highlightFeature(e) {
    var layer = e.target;

    layer.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
    });

    if (!L.Browser.ie && !L.Browser.opera) {
        layer.bringToFront();
    }
 info.update(layer.feature.properties);
}

function resetHighlight(e) {
    layer.resetStyle(e.target);
    info.update();
}


function zoomToFeature(e) {
    map.fitBounds(e.target.getBounds());
}




function onEachFeature(feature, layer) {
   
    layer.bindPopup("I am a test " + feature.properties.Med_Inc);
    layer.on({
        mouseover: highlightFeature,
        mouseout: resetHighlight,
        click: zoomToFeature
    });
}








var layer = new L.geoJson(edmon_data, {
            style: style,
            onEachFeature: onEachFeature
        }).addTo(map);









var healthIcon = L.icon({
    iconUrl: 'city-hospital-icon.png',

    iconSize:     [15, 15], // size of the icon
    iconAnchor:   [0, 0], // point of the icon which will correspond to marker's location
    popupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor
});


var van_hosp1 =  new L.geoJson(van_hosp, {
        
        pointToLayer: function (feature, latlng) {
            var pop = ' Kind of Health Facility: '+feature.properties.SV_NAME;
            return L.marker(latlng, {icon: healthIcon}).bindPopup(pop);
        }
}).addTo(map);


var searchControl = new L.esri.Geocoding.Controls.Geosearch()
    .addTo(map);
var results = new L.LayerGroup()
    .addTo(map);

searchControl.on('results', function(data) {
    results.clearLayers();
    for (var i = data.results.length - 1; i >= 0; i--) {
        results.addLayer(L.marker(data.results[i].latlng));
        results.clearLayers();
    }
});

var sidebar = $('#sidebar')
        .sidebar();
var info = L.control();

info.onAdd = function (map) {
    this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
    this.update();
    return this._div;
};

// method that we will use to update the control based on feature properties passed
info.update = function (props) {
    this._div.innerHTML = '<h4>Community Info</h4>' + (props ? '<b>' + props.CMANAME + '</b><br />' + props.CDNAME + ' ' : 'Select Your Community')
}




info.addTo(map);


var grades = [0, 12000, 20000, 25000, 35000, 45000, 50000];
var legend = L.control();
console.log(grades);

legend.onAdd = function(map,grades) {
	console.log(grades);
	var div = L.DomUtil.create('div', 'info legend'),
	grades = grades,
        labels = [];
        for (var i = 0; i < grades.length; i++) {div.innerHTML +='<i 			style="background:' + getColor(grades[i] + 1) + '"></i> ' + grades[i] 			+ (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');}
	        return div;
    };



legend.addTo(map);
legend._container.remove();
document.getElementById('messages')
        .appendChild(legend.onAdd(map));	









</script>

</body>
</html>


